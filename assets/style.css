:root{
  --bg:#0f1113; --card:#171a1e; --ink:#f6f7f9; --muted:#a0a6ad; --line:#2a2f36; --accent:#ffffff;
  --font-scale: 1; --btn-scale: 1;
  --topbar-h: 56px; --foot-h: 44px;
}
html, body { height: 100dvh; }
body{ margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; overflow:hidden; }

/* Topbar & Footer fixed */
.topbar{
  position:fixed; top:0; left:0; right:0; height:var(--topbar-h);
  background:#121418; border-bottom:1px solid var(--line);
  padding:0 1rem; display:flex; align-items:center; gap:.75rem; z-index:20;
}
.topbar h1{margin:0;font-size:1.05rem;font-weight:700;flex:1}
footer.foot{
  position:fixed; left:0; right:0; bottom:0; height:var(--foot-h);
  border-top:1px solid var(--line);
  padding:0 1rem; display:flex; align-items:center;
  font-size:.8rem; color:var(--muted); background:#121418; z-index:19;
}

/* Drawer */
.drawer{position:fixed;inset:0 40% 0 0;background:#14161a;border-right:1px solid var(--line);
  transform:translateX(-100%);transition:transform .2s;z-index:21}
.drawer.open{transform:translateX(0)}
.drawer header{padding:1rem;border-bottom:1px solid var(--line);font-weight:700}
.drawer nav a{display:flex;align-items:center;gap:.7rem;padding:.9rem 1rem;color:var(--ink);text-decoration:none;border-bottom:1px solid #15181c}
.drawer nav a:hover{background:#1b1e23}
.drawer nav a.active{background:#1b1e23;border-left:3px solid var(--accent)}

/* App content area */
main{
  position:relative;
  padding:1rem;
  padding-top: calc(1rem + var(--topbar-h));
  padding-bottom: calc(1rem + var(--foot-h));
  height: calc(100dvh - var(--topbar-h) - var(--foot-h));
  overflow:auto;
  display:grid; gap:1rem;
}

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:16px;
  padding:1.1rem;
  box-shadow:0 1px 4px rgba(0,0,0,0.25);
}
.row{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:.25rem}
input,select,textarea{
  width:100%;background:#14171a;border:1px solid #2c2f34;color:var(--ink);
  border-radius:12px;padding:.7rem .8rem;font-size:.95rem;transition:border .2s, background .2s;
}
input:focus,select:focus,textarea:focus{border-color:#6cb3ff;outline:none;background:#161a1f}

/* Buttons */
button{
  background:transparent;color:var(--ink);border:1px solid #3a3b3f;border-radius:14px;
  padding: calc(.7rem * var(--btn-scale)) calc(1.1rem * var(--btn-scale));
  min-height:44px;
  font-size: calc(1rem * var(--font-scale));
  font-weight:500; letter-spacing:.01em;
  transition:background .15s, color .15s, transform .15s;
}
button.primary{background:var(--accent);color:#000;border:0}
button.primary:hover{background:#f2f2f2;transform:scale(1.03)}
button.ghost:hover{background:#1c1f24}
.btn-row{display:flex;gap: calc(.6rem * var(--btn-scale));flex-wrap:wrap;row-gap:.4rem}

/* Tiles (Dashboard) */
.tiles{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.tile{
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  min-height:112px; border:1px solid var(--line); border-radius:18px;
  background:#15181c; text-align:center; padding:14px; cursor:pointer;
  box-shadow:0 1px 4px rgba(0,0,0,.25); transition:transform .12s, box-shadow .12s;
}
.tile:hover{transform:translateY(-1px);box-shadow:0 3px 12px rgba(0,0,0,.35)}
.tile .big{font-size:1.05rem; font-weight:600; margin-top:6px}
.tile .sub{font-size:.8rem; color:#aab; margin-top:2px}
.tile.primary{background:linear-gradient(180deg, #1a1d22 0%, #13161a 100%);}
.tile .icon{width:28px; height:28px; opacity:.95}

/* Map */
.map{height:60vh;border:1px solid var(--line);border-radius:12px;overflow:hidden; position:relative}

/* Floating Action Buttons on map */
.fab-wrap{position:absolute; right:12px; bottom:12px; display:flex; flex-direction:column; gap:10px; z-index:10; pointer-events:none;}
.fab{pointer-events:auto; width:44px; height:44px; border-radius:50%; border:1px solid #2b2e33; background:#101317; color:#e9e9ea;
     display:flex; align-items:center; justify-content:center; font-size:20px; box-shadow:0 2px 10px rgba(0,0,0,.45);}
.fab:hover{background:#171b20}

/* Badges & misc */
.badge{border:1px solid #3a3b3f;border-radius:999px;padding:.1rem .5rem;color:#ddd;font-size:.75rem;margin-right:.25rem}
.success{color:#9cff9c}.error{color:#ff8a8a}.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;color:#c7c7c7}
.hp-wrap{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.input-invalid{border-color:#ef4444 !important; box-shadow:0 0 0 2px rgba(239,68,68,.15); animation: invalid-pulse .26s ease;}
@keyframes invalid-pulse{from{transform:scale(1.005)}to{transform:scale(1)}

/* View transitions */
#view{opacity:1;transform:translateY(0);transition:opacity .18s ease, transform .18s ease}
.view-exit{opacity:0;transform:translateY(6px)}
.view-enter{opacity:1;transform:translateY(0)}

/* Responsive */
@media (max-width:700px){
  .row{grid-template-columns:1fr}
  .drawer{inset:0 30% 0 0}
  .map{height:50vh}
}

/* Toasts */
#toast-root{
  position:fixed; top:12px; right:12px; z-index:9999;
  display:flex; flex-direction:column; gap:10px; pointer-events:none;
}
.toast{
  min-width: 220px; max-width: 320px;
  background: rgba(23,26,30,.96);
  border:1px solid var(--line);
  border-radius:14px; padding:.75rem .9rem;
  color: var(--ink); box-shadow:0 6px 20px rgba(0,0,0,.35);
  font-size:.9rem; line-height:1.25; display:flex; align-items:flex-start; gap:.6rem;
  transform: translateY(-6px); opacity:0; animation: toast-in .18s ease forwards;
}
.toast .dot{width:8px; height:8px; border-radius:50%; margin-top:.35rem; flex:0 0 8px;}
.toast.success .dot{background:#22c55e}
.toast.error   .dot{background:#ef4444}
.toast.info    .dot{background:#60a5fa}
.toast .close{
  margin-left:auto; background:transparent; border:0; color:#aab; cursor:pointer;
  font-size:.95rem; line-height:1; padding:0 .2rem; pointer-events:auto;
}
@keyframes toast-in{to{transform:translateY(0);opacity:1}}
@keyframes toast-out{to{transform:translateY(-6px);opacity:0)}

#settingsTitle{cursor:pointer}
